<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù…Ù‚Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</title>

  <link rel="stylesheet" href="global.css">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      background: #eef3f9;
      font-family: "Cairo", sans-serif;
    }

    .article-container {
      margin-left: 260px;
      margin-top: 100px;
      background: white;
      padding: 30px;
      border-radius: 20px;
      width: 75%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.06);
    }

    h2 {
      margin-bottom: 8px;
    }

    .desc {
      opacity: .7;
      margin-bottom: 20px;
    }

    #editor {
      min-height: 350px;
    }

    .actions {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }

    .save-btn {
      background: #4b6fff;
      color: white;
      padding: 10px 22px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
    }

    .delete-btn {
      background: #ff4b4b;
      color: white;
      padding: 10px 22px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
    }
  </style>

  <!-- CKEDITOR 5 CLASSIC -->
  <script src="https://cdn.ckeditor.com/ckeditor5/40.2.0/classic/ckeditor.js"></script>

</head>

<body>

  <div id="sidebar"></div>
  <script src="sidebar.js"></script>

  <div class="top-nav">
    <div class="nav-left">
      <h1>Ù…Ù‚Ø§Ù„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</h1>
    </div>
  </div>

  <div class="article-container">

    <h2 id="cardTitle">â€”</h2>
    <p id="cardDesc" class="desc">â€”</p>

    <div id="editor"></div>

    <div class="actions">
      <button class="save-btn" onclick="saveArticle()">Ø­ÙØ¸</button>
      <button class="delete-btn" onclick="deleteArticle()">Ø­Ø°Ù</button>
    </div>

  </div>

  <script>
    let shelfIndex = localStorage.getItem("selectedShelf");
    let cardIndex  = localStorage.getItem("selectedCard");

    let cards = JSON.parse(localStorage.getItem("shelf_cards_" + shelfIndex)) || [];
    let current = cards[cardIndex];

    document.getElementById("cardTitle").innerText = current?.title || "â€”";
    document.getElementById("cardDesc").innerText  = current?.desc || "";

    let editorInstance;

    ClassicEditor
      .create(document.querySelector('#editor'))
      .then(editor => {
          editorInstance = editor;

          let saved = localStorage.getItem("card_article_" + shelfIndex + "_" + cardIndex);
          if (saved) editor.setData(saved);
      })
      .catch(error => { console.error(error); });

    function saveArticle() {
      let data = editorInstance.getData();
      localStorage.setItem("card_article_" + shelfIndex + "_" + cardIndex, data);
      alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù‚Ø§Ù„ ğŸ‘");
    }

    function deleteArticle() {
      if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„ØŸ")) return;
      localStorage.removeItem("card_article_" + shelfIndex + "_" + cardIndex);
      editorInstance.setData("");
    }
  </script>

</body>
</html>
