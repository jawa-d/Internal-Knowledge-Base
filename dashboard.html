<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            cairo: ['Cairo', 'sans-serif'],
          },
          colors: {
            primary: '#0038a8',
            accent: '#00c2a8',
            danger: '#ef4444',
          }
        }
      }
    }
  </script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Core Styles -->
  <link rel="stylesheet" href="sidebar.css">
  <link rel="stylesheet" href="dashboard.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="font-cairo bg-slate-100 dark:bg-slate-900 min-h-screen transition-colors">

<!-- ================= Sidebar ================= -->
<div id="sidebar"></div>
<script src="sidebar.js"></script>

<!-- ================= Page Content ================= -->
<div class="page dashboard-page relative">

  <!-- ================= Header ================= -->
  <div class="dash-header flex items-center justify-between mb-8">
    <div>
      <h1 class="text-3xl font-bold text-slate-800 dark:text-white">Dashboard</h1>
      <p class="text-slate-500 dark:text-slate-400 mt-1">نظرة عامة على أداء النظام</p>
    </div>

    <div id="loggedUserBox" class="logged-user-box">
      <span id="loggedUserEmail" class="email">loading...</span>
    </div>

    <button
      id="logoutBtn"
      class="px-4 py-2 rounded-xl bg-danger text-white shadow hover:opacity-90 transition">
      تسجيل الخروج
    </button>
  </div>

  <!-- ================= KPI CARDS ================= -->
  <div class="cards mb-10">

    <div onclick="location.href='users.html'" class="card users">
      <div class="icon"><i data-lucide="users"></i></div>
      <div>
        <div class="label">عدد المستخدمين</div>
        <div class="number" id="usersCount">0</div>
      </div>
    </div>

    <div onclick="location.href='shelves.html'" class="card shelves">
      <div class="icon"><i data-lucide="folders"></i></div>
      <div>
        <div class="label">عدد الرفوف</div>
        <div class="number" id="shelvesCount">0</div>
      </div>
    </div>

    <div onclick="location.href='news.html'" class="card news">
      <div class="icon"><i data-lucide="newspaper"></i></div>
      <div>
        <div class="label">عدد الأخبار</div>
        <div class="number" id="newsCount">0</div>
      </div>
    </div>

    <div onclick="location.href='kpi_productivity.html'" class="card kpi">
      <div class="icon"><i data-lucide="bar-chart-3"></i></div>
      <div>
        <div class="label">مؤشرات KPI</div>
        <div class="number" id="kpiCount">0</div>
      </div>
    </div>

    <div onclick="location.href='exam.html'" class="card exams">
      <div class="icon"><i data-lucide="clipboard-check"></i></div>
      <div>
        <div class="label">موظفو الامتحان</div>
        <div class="number" id="examUsersCount">0</div>
      </div>
    </div>

  </div>

  <!-- ================= Charts Section ================= -->
  <div class="charts-wrapper">

    <div class="charts-row charts-row--big">
      <div class="chart-card chart-card--big">
        <h3>عدد المستخدمين</h3>
        <canvas id="usersChart"></canvas>
      </div>

      <div class="chart-card chart-card--big">
        <h3>تطور مؤشرات KPI</h3>
        <canvas id="kpiChart"></canvas>
      </div>
    </div>

    <div class="charts-row charts-row--small">
      <div class="chart-card">
        <h3>عدد الرفوف</h3>
        <canvas id="shelvesChart"></canvas>
      </div>

      <div class="chart-card">
        <h3>عدد الكتب</h3>
        <canvas id="booksChart"></canvas>
      </div>

      <div class="chart-card">
        <h3>موظفو الامتحان (شهري)</h3>
        <canvas id="examUsersChart"></canvas>
      </div>
    </div>

  </div>

</div>

<!-- ================= App Logic ================= -->
<script type="module" src="dashboard.js"></script>
<script type="module">
  import { runAnnouncementPopup } from "./announcement_popup.js";
  runAnnouncementPopup();
</script>

<!-- ================= Lucide Icons ================= -->
<script src="https://unpkg.com/lucide@latest"></script>
<script>
  lucide.createIcons();
</script>

</body>
</html>
